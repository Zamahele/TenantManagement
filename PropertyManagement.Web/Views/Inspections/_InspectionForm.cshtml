@model PropertyManagement.Web.ViewModels.InspectionViewModel
@{
  bool isEdit = Model.InspectionId != 0;
}

<!-- Form Error Display -->
<div id="formErrors" class="alert alert-danger" style="display: none;"></div>
<div id="formSuccess" class="alert alert-success" style="display: none;"></div>

<form id="inspectionForm" asp-action="CreateOrEdit" method="post" autocomplete="off" class="needs-validation" novalidate>
  @Html.AntiForgeryToken()
  <input type="hidden" asp-for="InspectionId" />
  
  <div class="row g-4">
    <!-- Left Column -->
    <div class="col-lg-6">
      <div class="mb-3">
        <label asp-for="RoomId" class="form-label fw-semibold">Room <span class="text-danger">*</span></label>
        <div class="input-group">
          <span class="input-group-text">
            <i class="bi bi-door-closed"></i>
          </span>
          <select asp-for="RoomId" asp-items="Model.RoomOptions" class="form-select" required>
            <option value="">-- Select Room --</option>
          </select>
        </div>
        <div class="invalid-feedback">Please select a room.</div>
      </div>
      
      <div class="mb-3">
        <label asp-for="Date" class="form-label fw-semibold">Inspection Date <span class="text-danger">*</span></label>
        <div class="input-group">
          <span class="input-group-text">
            <i class="bi bi-calendar3"></i>
          </span>
          <input asp-for="Date" class="form-control" type="date" required />
        </div>
        <div class="invalid-feedback">Please select an inspection date.</div>
        <small class="text-muted">Date when the inspection was or will be conducted</small>
      </div>
    </div>

    <!-- Right Column -->
    <div class="col-lg-6">
      <div class="mb-3">
        <label asp-for="Result" class="form-label fw-semibold">Result <span class="text-danger">*</span></label>
        <div class="input-group">
          <span class="input-group-text">
            <i class="bi bi-clipboard-check"></i>
          </span>
          <select asp-for="Result" class="form-select" required>
            <option value="">-- Select Result --</option>
            <option value="Passed">Passed</option>
            <option value="Failed">Failed</option>
            <option value="Pending">Pending</option>
            <option value="Requires Follow-up">Requires Follow-up</option>
          </select>
        </div>
        <div class="invalid-feedback">Please select an inspection result.</div>
      </div>
    </div>
    
    <!-- Full Width Notes -->
    <div class="col-12">
      <div class="mb-3">
        <label asp-for="Notes" class="form-label fw-semibold">Inspection Notes</label>
        <div class="input-group">
          <span class="input-group-text">
            <i class="bi bi-chat-text"></i>
          </span>
          <textarea asp-for="Notes" class="form-control" rows="4" placeholder="Add detailed notes about the inspection findings..."></textarea>
        </div>
        <small class="text-muted">Document inspection findings, issues identified, or recommendations</small>
      </div>
    </div>
  </div>
</form>

<div class="row mt-4">
  <div class="col-12">
    <div class="d-flex justify-content-end gap-2">
      <button type="button" class="btn btn-secondary" onclick="closeInspectionModal()">
        <i class="bi bi-x-circle"></i> Cancel
      </button>
      <button type="submit" class="btn btn-primary" form="inspectionForm">
        <i class="bi bi-clipboard-check"></i> 
        <span class="submit-text">@(isEdit ? "Update Inspection" : "Save Inspection")</span>
        <div class="spinner-border spinner-border-sm ms-2" style="display: none;" role="status" aria-hidden="true"></div>
      </button>
    </div>
  </div>
</div>

<script type="text/javascript">
  // Form initialization will be handled by parent page JavaScript
  document.addEventListener('DOMContentLoaded', function() {
    if (document.getElementById('inspectionForm') && typeof initializeInspectionForm === 'function') {
      initializeInspectionForm();
    }
  });
  
  // Initialize immediately for dynamic content
  setTimeout(function() {
    if (document.getElementById('inspectionForm') && typeof initializeInspectionForm === 'function') {
      initializeInspectionForm();
    }
  }, 100);
</script>