@using PropertyManagement.Web.ViewModels
@model RoomFormViewModel
@{
  bool isEdit = Model?.RoomId > 0;
}

<!-- Form Error Display -->
<div id="formErrors" class="alert alert-danger" style="display: none;"></div>
<div id="formSuccess" class="alert alert-success" style="display: none;"></div>

<form id="roomForm" asp-action="CreateOrEdit" method="post" autocomplete="off" class="needs-validation" novalidate>
  @Html.AntiForgeryToken()
  <input type="hidden" asp-for="RoomId" />
  
  <div class="row g-4">
    <!-- Left Column -->
    <div class="col-lg-6">
      <div class="mb-3">
        <label asp-for="Number" class="form-label fw-semibold">Room Number <span class="text-danger">*</span></label>
        <div class="input-group">
          <span class="input-group-text">
            <i class="bi bi-hash"></i>
          </span>
          <input asp-for="Number" class="form-control" maxlength="20" placeholder="e.g. 101, A2, Room-5" required />
        </div>
        <div class="invalid-feedback">Please enter a valid room number.</div>
        <small class="text-muted">Enter a unique room identifier (max 20 characters)</small>
      </div>
      
      <div class="mb-3">
        <label asp-for="Type" class="form-label fw-semibold">Room Type <span class="text-danger">*</span></label>
        <div class="input-group">
          <span class="input-group-text">
            <i class="bi bi-house"></i>
          </span>
          <select asp-for="Type" asp-items="Model.RoomTypes" class="form-select" required>
            <option value="">-- Select Room Type --</option>
          </select>
        </div>
        <div class="invalid-feedback">Please select a room type.</div>
        <small class="text-muted">Choose the type of room (Single, Double, etc.)</small>
      </div>
    </div>

    <!-- Right Column -->
    <div class="col-lg-6">
      <div class="mb-3">
        <label asp-for="Status" class="form-label fw-semibold">Room Status <span class="text-danger">*</span></label>
        <div class="input-group">
          <span class="input-group-text">
            <i class="bi bi-circle-fill"></i>
          </span>
          <select asp-for="Status" asp-items="Model.StatusOptions" class="form-select" required>
            <option value="">-- Select Status --</option>
          </select>
        </div>
        <div class="invalid-feedback">Please select a room status.</div>
        <small class="text-muted">Current availability status of the room</small>
      </div>

      <div class="mb-3">
        <div class="card border-info bg-light">
          <div class="card-body p-3">
            <h6 class="card-title text-info mb-2">
              <i class="bi bi-info-circle"></i> Room Information
            </h6>
            <div id="roomSummary">
              <p class="mb-1"><strong>ID:</strong> <span id="roomIdDisplay">@(isEdit ? Model.RoomId.ToString() : "New Room")</span></p>
              <p class="mb-0"><strong>Action:</strong> <span id="roomAction">@(isEdit ? "Update existing room" : "Create new room")</span></p>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</form>

<div class="row mt-4">
  <div class="col-12">
    <div class="d-flex justify-content-end gap-2">
      <button type="button" class="btn btn-secondary" onclick="closeRoomModal()">
        <i class="bi bi-x-circle"></i> Cancel
      </button>
      <button type="submit" class="btn btn-primary" form="roomForm">
        <i class="bi bi-save"></i>
        <span class="submit-text">@(isEdit ? "Update Room" : "Save Room")</span>
        <div class="spinner-border spinner-border-sm ms-2" style="display: none;" role="status" aria-hidden="true"></div>
      </button>
    </div>
  </div>
</div>

<script type="text/javascript">
  document.addEventListener('DOMContentLoaded', function() {
    if (document.getElementById('roomForm') && typeof initializeRoomForm === 'function') {
      initializeRoomForm();
    }
  });
  
  setTimeout(function() {
    if (document.getElementById('roomForm') && typeof initializeRoomForm === 'function') {
      initializeRoomForm();
    }
  }, 100);
</script>

